<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 
Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsf/core"
	xmlns:f="http://java.sun.com/jsf/core">

<ui:composition template="base.xhtml">

	<ui:define name="header">
		<h:outputStylesheet name="css/user.css" />
		<h:outputStylesheet name="css/table.css" />
	</ui:define>
	
	<ui:define name="content">
		<!-- Event-Informationen -->
		<h:panelGroup layout="block"
			rendered="#{userProfileForm.user != null}">
			<h1 class="heading">
				<h:outputText
					value="Angemeldet als #{userProfileForm.user.firstname} #{userProfileForm.user.lastname}" />
			</h1>
		</h:panelGroup>


		<div class="container-fluid">
			<div class="row">
				<div class="col-md-10 col-md-offset-1">
					<h:panelGroup class="panel panel-primary" layout="block">
						<div class="panel-heading">
							<h3 class="panel-title">Benutzerdaten</h3>
						</div>
						<div class="panel-body">
							<h:form class="form-horizontal" id="userForm">
								<div class="col-md-6 form-group">
									<div class="form-group">
										<div class="col-md-3 col-md-offset-1">
											<h:outputLabel>Vorname</h:outputLabel>
										</div>
										<div class="col-md-8">
											<h:inputText id="inputFirstname" class="form-control" value="#{userProfileForm.firstname}" >
												<f:validator validatorId="userFirstnameValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputFirstname" class="alert alert-danger error" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-3 col-md-offset-1">
											<h:outputLabel>Nachname</h:outputLabel>
										</div>
										<div class="col-md-8">
											<h:inputText id="inputLastname" class="form-control" value="#{userProfileForm.lastname}" >
												<f:validator validatorId="userLastnameValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputLastname" class="alert alert-danger error" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-3 col-md-offset-1">
											<h:outputLabel>Straße / Hausnummer</h:outputLabel>
										</div>
										<div class="col-md-5">
											<h:inputText id="inputStreet" class="form-control" value="#{userProfileForm.street}">
												<f:validator validatorId="streetValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputStreet" class="alert alert-danger error"
													showDetail="false" showSummary="true" />
											</div>
										</div>
										<div class="col-md-3">
											<h:inputText id="inputHousenumber" class="form-control" value="#{userProfileForm.housenumber}">
												<f:validator validatorId="housenumberValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputHousenumber" class="alert alert-danger error" showDetail="false" showSummary="true" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-3 col-md-offset-1">
											<h:outputLabel>PLZ / Ort</h:outputLabel>
										</div>
										<div class="col-md-3">
											<h:inputText id="inputZIP" class="form-control" value="#{userProfileForm.zip}" >
												<f:validator validatorId="zipValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputZIP" class="alert alert-danger error"
													showDetail="false" showSummary="true" />
											</div>
										</div>
										
										<div class="col-md-5">
											<h:inputText id="inputCity" class="form-control" value="#{userProfileForm.city}" >
												<f:validator validatorId="cityValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputCity" class="alert alert-danger error" showDetail="false" showSummary="true" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-3 col-md-offset-1">
											<h:outputLabel class="control-label">E-Mail</h:outputLabel>
										</div>
										<div class="col-md-8">
											<h:inputText id="inputEmail" class="form-control" value="#{userProfileForm.email}" >
												<f:validator validatorId="userEmailValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="inputEmail" class="alert alert-danger error" />
											</div>
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<div class="col-md-3">
											<h:outputLabel>Kontoinhaber</h:outputLabel>
										</div>
										<div class="col-md-9">
											<h:inputText class="form-control" id="accountHolder" value="#{userProfileForm.accountHolder}">
												<f:validator validatorId="accountHolderValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="accountHolder" class="alert alert-danger error" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-3">
											<h:outputLabel>IBAN</h:outputLabel>
										</div>
										<div class="col-md-9">
											<h:inputText class="form-control" id="iban" value="#{userProfileForm.iban}">
												<f:validator validatorId="ibanValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="iban" class="alert alert-danger error" />
											</div>
										</div>
									</div>
									<div class="form-group">
										<div class="col-md-3">
											<h:outputLabel>BIC</h:outputLabel>
										</div>
										<div class="col-md-9">
											<h:inputText class="form-control" id="bic" value="#{userProfileForm.bic}">
												<f:validator validatorId="bicValidator" />
											</h:inputText>
											<div class="error">
												<h:message for="bic" class="alert alert-danger error" />
											</div>
										</div>
									</div>

									<div class="form-group btnSave" >
										<div class="col-md-2 col-md-offset-10">
											<h:commandButton class="btn btn-success btn-md" action="#{userProfileForm.save}" value="Speichern" />
										</div>
									</div>
								</div>
							</h:form>
						</div>
					</h:panelGroup>
				</div>
			</div>
		</div>

		<div class="container-fluid">
			<div class="row">
				<div class="col-md-10 col-md-offset-1">
					<h:panelGroup class="panel panel-danger panel-table"
						rendered="#{empty userProfileForm.user.bookings}" layout="block">
						<div class="panel-heading">
							<h3 class="panel-title">Keine Bestellungen</h3>
						</div>
						<div class="panel-body"></div>
					</h:panelGroup>
				</div>
			</div>
		</div>
		<div id="showOrders" class="col-md-10 col-md-offset-1">
			<h:panelGroup class="panel panel-primary panel-table"
				rendered="#{not empty userProfileForm.user.bookings}"
				layout="block">
				<div class="panel-heading">
					<h3 class="panel-title">Ihre Bestellungen</h3>
				</div>
				<div class="panel-body">
					<h:dataTable value="#{userProfileForm.user.bookings}" var="booking"
						class="table table-hover table-bordered">
						<h:column>
							<c:facet name="header">Bild</c:facet>
							<h:graphicImage value="#{booking.event.filename}" class="img-rounded smallImg" />
						</h:column>
						<h:column>
							<c:facet name="header">Veranstaltung</c:facet>
							<h:link outcome="event" value="#{booking.event.name}">
								<f:param name="id" value="#{booking.event.eventId}" />
							</h:link>
						</h:column>
						<h:column>
							<c:facet name="header">Datum</c:facet>
							<h:outputText pattern="dd.MM.YYYY"
								value="#{booking.event.datetime}">
								<f:converter converterId="LocalDateConverterID" />
							</h:outputText>
						</h:column>
						<h:column>
							<c:facet name="header">Uhrzeit</c:facet>
							<h:outputText pattern="HH:mm" value="#{booking.event.datetime}">
								<f:converter converterId="LocalDateConverterID" />
							</h:outputText>
						</h:column>
						<h:column>
							<c:facet name="header">Location</c:facet>
							<h:outputText value="#{booking.event.address.locationName}" />
						</h:column>
						<h:column>
							<c:facet name="header">Ort</c:facet>
							<h:outputText value="#{booking.event.address.city}" />
						</h:column>
						<h:column>
							<c:facet name="header">Reserviert Parkett</c:facet>
							<h:outputText value="#{booking.amountNormalTickets}" />
						</h:column>
						<h:column>
							<c:facet name="header">Reserviert Loge</c:facet>
							<h:outputText value="#{booking.amountPremiumTickets}" />
						</h:column>
						<h:column>
							<c:facet name="header">Preis</c:facet>
							<h:outputText value="#{booking.price} €" />
						</h:column>
						<h:column>
							<c:facet name="header">Reservierungscode</c:facet>
							<h:outputText value="#{booking.bookingUUID}" />
						</h:column>
					</h:dataTable>
				</div>
			</h:panelGroup>
		</div>
	</ui:define>
</ui:composition>
</html>